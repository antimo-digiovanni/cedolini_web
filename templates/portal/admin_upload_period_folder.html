{% extends "portal/base.html" %}
{% block title %}Importa Cedolini (Con Conferma){% endblock %}

{% block content %}
<div class="card card-custom p-4">
  <h3 class="mb-1">Importa Cedolini (Con Conferma)</h3>

  <div class="text-muted mb-3">
    Carica PDF con formato:
    <br>
    <strong>COGNOME - NOME - MESE ANNO.pdf</strong>
    <br><br>
    Se il dipendente esiste:
    ✔️ Il cedolino viene salvato automaticamente
    <br>
    Se il dipendente NON esiste:
    ✔️ Ti verrà chiesto se crearlo oppure scartarlo
  </div>

  {% if messages %}
    {% for m in messages %}
      <div class="alert alert-{{ m.tags }} mb-2">{{ m }}</div>
    {% endfor %}
  {% endif %}

  <form method="post" enctype="multipart/form-data" class="mt-3">
    {% csrf_token %}

    <div class="mb-3">
      <label class="form-label">File PDF (multi-selezione o cartella)</label>
      <input type="file"
             name="files"
             class="form-control"
             multiple
             webkitdirectory
             directory
             required>
      <div class="form-text">
        Puoi selezionare tutti i PDF insieme oppure una cartella intera.
      </div>
    </div>

    <button class="btn btn-primary" type="submit">
      <i class="bi bi-cloud-upload"></i> Importa
    </button>
  </form>
</div>

<div class="card card-custom p-4 mt-4">
  <h5 class="mb-3">Report Import</h5>

  <ul class="mb-0">
    <li><strong>Salvati dipendenti esistenti:</strong> {{ report.saved_existing }}</li>
    <li><strong>Nuovi dipendenti trovati:</strong> {{ report.new_found }}</li>
    <li><strong>Errori:</strong> {{ report.errors }}</li>
  </ul>
</div>
{% endblock %}